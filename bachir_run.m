clc;
clear;
close;

addpath('src');
addpath('bachir_imr');

% equation options
R0 = 2.447495043190468e-04;
Req = 5.503626087876410e-05;
tfin = R0/3;
pzero = 0.001887748193919;
cstar = 1.520710024149080e+02;
kappa = 1.4;
Lheat = 2.378193575129533e+04;
T8 = 298.15;
rho8 = 1064;
tvector = linspace(0,tfin,1000);
radial = 2;
vapor = 0;
bubtherm = 1;
medtherm = 0;
masstrans = 0;
stress = 1;
varin = {'radial',radial,...
         'bubtherm',bubtherm,...
         'tvector',tvector,...
         'vapor',vapor,...
         'medtherm',medtherm,...
         'stress',stress,...
         're',92.055015921905493,...
         'we',1.722169689244959e+02,...
         'ca',3.242400000000000e+02,...
         'r0',R0,...
         'req',Req,...
         'pzero',pzero,...
         'cstar',cstar,...
         'kappa',kappa,...
         'masstrans',0,...
         'lheat',Lheat,...
         't8',T8,...
         'rho8',rho8};
[tf,Rf,Uf] = m_imr_finitediff(varin{:},'Nt',200,'Mt',200);
[ts,Rs,Us] = m_imr_spectral(varin{:},'Nt',12,'Mt',12);

figure(1)
hold on;
plot(tf,Rf,'^')
plot(ts,Rs,'o')
clear
run Run_IMR_Results.m