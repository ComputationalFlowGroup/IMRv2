clc;
clear;
close;

addpath('src/forward_solver/');

% equation options
R0 = 2.447495043190468e-04;
Req = 3.008409399929516e-05;
ratio = Req/R0;
Req = R0;
tfin = 2e-3;
kappa = 1.4;
Lheat = 2.378193575129533e+04;
T8 = 298.15;
rho8 = 1064;
tvector = linspace(0,tfin,1000);
radial = 2;
vapor = 1;
bubtherm = 0;
medtherm = 0;
masstrans = 0;
stress = 1;
wave_type = 1;
dt = 3e-4;
tw = 1e-4;
pA = 1e5;
varin = {'progdisplay',0,...
    'radial',radial,...
         'bubtherm',bubtherm,...
         'tvector',tvector,...
         'vapor',vapor,...
         'medtherm',medtherm,...
         'method',23,...
         'stress',stress,...
         'mu',0.5,...
         'g',3.125000000000000e+02,...
         'lambda1',0,...
         'r0',R0,...
         'req',Req,...
         'kappa',kappa,...
         'masstrans',masstrans,...
         't8',T8,...
         'rho8',rho8,...
         'wave_type',wave_type,...
         'dt',dt,...
         'tw',tw,...
         'pA',pA};

[t3,R3,U3,P3] = f_imr_fd(varin{:},'Nt',50,'Mt',50);

figure(1)
hold on;
plot(t3,R3,'bs')
% plot(t3,P3,'rs')
% ylim([0 1.2])