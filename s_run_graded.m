clc;
clear;
close;

addpath('src/forward_solver/');

% equation options
R0 = 50e-6;
Req = R0/10;
tfin = 15E-6;
kappa = 1.4;
Lheat = 2.378193575129533e+04;
T8 = 298.15;
rho8 = 1064;
tvector = linspace(0,tfin,100);
radial = 1;
vapor = 1;
bubtherm = 1;
medtherm = 1;
masstrans = 1;
stress = 1;
varin = {'progdisplay',0,...
    'radial',radial,...
         'bubtherm',bubtherm,...
         'tvector',tvector,...
         'vapor',vapor,...
         'medtherm',medtherm,...
         'method',23,...
         'stress',stress,...
         'collapse',1,...
         'mu',1E-4,...
         'g',1500,...
         'graded',1,...
         'g1',3000,...
         'l1',1.5*R0,...
         'l2',2.5*R0,...
         'v_a',2,...
         'v_nc',0.3,...
         'lambda1',1e-7,...
         'lambda2',0,...
         'alphax',1e-3,...
         'r0',R0,...
         'req',Req,...
         'kappa',kappa,...
         't8',T8,...
         'rho8',rho8};

[t,R,~] = m_imr_fd(varin{:},'Nt',70,'Mt',70);

figure(1)
hold on;
plot(t,R,'bx')
ylim([0 1.2])

addpath('./examples')
Pref = 101325; G = 1500; G1 = 3000; 
Ca = Pref/G;
Ca1 = Pref/G1;
mu8 = 8.3283e-4; % infinite strain rate viscosity
Uc = sqrt(Pref/rho8);
Re8 = Pref*R0/(mu8*Uc);
l1 = 1.5*R0; 
l2 = 2.5*R0;
v_nc = 0.3; 
v_a = 2;
%iDRe = 0; intfnu = 0;
figure(2)
hold on;
f_stress_field
